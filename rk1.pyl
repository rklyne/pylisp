
; The variables

(def x 3)
(def a 1)

; The function declaration

(def f
  (fn [x]
    (+ x a 1)))

(print (f 2))
(print (f 8))

; The same function, done the macro way.

(defn g [x]
  (+ x a 1))

(print (g 2))
(print (g 8))



(defmacro withlock [lock &code]
  (list
    'progn
    '(. lock acquire)
    (cons 'progn (list 'binding '[name raise-error] code))
    '(. lock release)
  )) 

